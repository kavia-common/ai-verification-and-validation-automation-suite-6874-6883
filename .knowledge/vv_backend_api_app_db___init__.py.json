{"is_source_file": true, "format": "Python", "description": "This file sets up database connection management and session handling for the backend API using SQLAlchemy. It includes functions for configuring the database URL (either from environment variables or defaults to SQLite), creating the engine and session factory, providing scoped sessions, and initializing the database with model definitions during application startup.", "external_files": ["from . import models"], "external_methods": ["create_engine", "scoped_session", "sessionmaker", "Session", "declarative_base"], "published": ["get_db", "session_scope", "init_db"], "classes": [], "methods": [{"name": "str _build_sqlite_url(data_dir: str)", "description": "Builds a SQLite URL pointing to a file in the specified data directory.", "scope": "", "scopeKind": ""}, {"name": "str _get_database_url()", "description": "Retrieves the database URL from environment variables or constructs a default SQLite URL.", "scope": "", "scopeKind": ""}, {"name": "dict _engine_connect_args(db_url: str)", "description": "Provides database-specific connection arguments, such as 'check_same_thread' for SQLite.", "scope": "", "scopeKind": ""}, {"name": "get_engine()", "description": "Creates or retrieves the singleton SQLAlchemy engine.", "scope": "", "scopeKind": ""}, {"name": "get_session_factory()", "description": "Creates or retrieves the singleton scoped session factory bound to the engine.", "scope": "", "scopeKind": ""}, {"name": "Session get_db()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "init_db(app=None)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "remove_session(response_or_exc)", "scope": "init_db", "scopeKind": "function", "description": "unavailable"}, {"name": "Iterator[Session] session_scope()", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["os.getenv", "os.makedirs", "os.path.join", "os.path.abspath", "create_engine", "sessionmaker", "scoped_session", "Base.metadata.create_all", "get_engine", "get_session_factory"], "search-terms": ["SQLAlchemy session management", "database initialization", "scoped_session", "init_db", "session_scope", "database URL environment variable"], "state": 2, "file_id": 7, "knowledge_revision": 37, "git_revision": "b01d050475d9be5a9bac9c1f2a6924e0cc10784c", "revision_history": [{"16": "2269f2d3a8e1087d10781b5c2f582754d8b89c03"}, {"37": "b01d050475d9be5a9bac9c1f2a6924e0cc10784c"}], "ctags": [{"_type": "tag", "name": "Base", "path": "/home/kavia/workspace/code-generation/ai-verification-and-validation-automation-suite-6874-6883/vv_backend_api/app/db/__init__.py", "pattern": "/^Base = declarative_base()$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_SessionFactory", "path": "/home/kavia/workspace/code-generation/ai-verification-and-validation-automation-suite-6874-6883/vv_backend_api/app/db/__init__.py", "pattern": "/^_SessionFactory: Optional[scoped_session] = None$/", "language": "Python", "typeref": "typename:Optional[scoped_session]", "kind": "variable"}, {"_type": "tag", "name": "_build_sqlite_url", "path": "/home/kavia/workspace/code-generation/ai-verification-and-validation-automation-suite-6874-6883/vv_backend_api/app/db/__init__.py", "pattern": "/^def _build_sqlite_url(data_dir: str) -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "(data_dir: str)"}, {"_type": "tag", "name": "_engine", "path": "/home/kavia/workspace/code-generation/ai-verification-and-validation-automation-suite-6874-6883/vv_backend_api/app/db/__init__.py", "pattern": "/^_engine = None  # type: ignore$/", "language": "Python", "kind": "variable"}, {"_type": "tag", "name": "_engine_connect_args", "path": "/home/kavia/workspace/code-generation/ai-verification-and-validation-automation-suite-6874-6883/vv_backend_api/app/db/__init__.py", "pattern": "/^def _engine_connect_args(db_url: str) -> dict:$/", "language": "Python", "typeref": "typename:dict", "kind": "function", "signature": "(db_url: str)"}, {"_type": "tag", "name": "_get_database_url", "path": "/home/kavia/workspace/code-generation/ai-verification-and-validation-automation-suite-6874-6883/vv_backend_api/app/db/__init__.py", "pattern": "/^def _get_database_url() -> str:$/", "language": "Python", "typeref": "typename:str", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_db", "path": "/home/kavia/workspace/code-generation/ai-verification-and-validation-automation-suite-6874-6883/vv_backend_api/app/db/__init__.py", "pattern": "/^def get_db() -> Session:$/", "language": "Python", "typeref": "typename:Session", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_engine", "path": "/home/kavia/workspace/code-generation/ai-verification-and-validation-automation-suite-6874-6883/vv_backend_api/app/db/__init__.py", "pattern": "/^def get_engine():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "get_session_factory", "path": "/home/kavia/workspace/code-generation/ai-verification-and-validation-automation-suite-6874-6883/vv_backend_api/app/db/__init__.py", "pattern": "/^def get_session_factory():$/", "language": "Python", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "init_db", "path": "/home/kavia/workspace/code-generation/ai-verification-and-validation-automation-suite-6874-6883/vv_backend_api/app/db/__init__.py", "pattern": "/^def init_db(app=None):$/", "language": "Python", "kind": "function", "signature": "(app=None)"}, {"_type": "tag", "name": "remove_session", "path": "/home/kavia/workspace/code-generation/ai-verification-and-validation-automation-suite-6874-6883/vv_backend_api/app/db/__init__.py", "pattern": "/^        def remove_session(response_or_exc):$/", "file": true, "language": "Python", "kind": "function", "signature": "(response_or_exc)", "scope": "init_db", "scopeKind": "function"}, {"_type": "tag", "name": "session_scope", "path": "/home/kavia/workspace/code-generation/ai-verification-and-validation-automation-suite-6874-6883/vv_backend_api/app/db/__init__.py", "pattern": "/^def session_scope() -> Iterator[Session]:$/", "language": "Python", "typeref": "typename:Iterator[Session]", "kind": "function", "signature": "()"}], "hash": "2aa6c411779deaf7c7f5602106771371", "format-version": 4, "code-base-name": "vv_backend_api", "filename": "vv_backend_api/app/db/__init__.py", "fields": [{"name": "Base = declarative_base()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "Optional[scoped_session] _SessionFactory", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "_engine = None  # type: ignore", "scope": "", "scopeKind": "", "description": "unavailable"}]}